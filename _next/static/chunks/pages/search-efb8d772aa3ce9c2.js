(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[612],{4976:(e,n,t)=>{"use strict";t.d(n,{A:()=>U});var r=t(2819),i=t(6540),o=t(3556),a=t(8967),s=t(5703),c=t(7500),l=t(6043),h=t(4104),u=t(2062),d=t(8495),p=t(7239),x=t(404),f=t(1801),m=t(8348),g=t(5956),v=t(1952),j=t(3156),A=t(1423),w=t(574),b=t(6715),_=t(5315),y=t(7400),C=t(7585),k=t(6860),S=t(4848),E=t(7836),R=(0,a.Ay)("div")(function(e){var n=e.theme;return(0,o.A)({position:"relative",borderRadius:n.shape.borderRadius,backgroundColor:(0,s.X4)(n.palette.common.white,.15),"&:hover":{backgroundColor:(0,s.X4)(n.palette.common.white,.25)},marginRight:n.spacing(2),marginLeft:0,width:"100%"},n.breakpoints.up("sm"),{marginLeft:n.spacing(3),width:"auto"})}),L=(0,a.Ay)("div")(function(e){return{padding:e.theme.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}}),I=(0,a.Ay)(y.Ay)(function(e){var n=e.theme;return{color:"inherit","& .MuiInputBase-input":(0,o.A)({padding:n.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(n.spacing(4),")"),transition:n.transitions.create("width"),width:"100%"},n.breakpoints.up("md"),{width:"20ch"})}}),N=[{name:"首页",path:"/"},{name:"文档",path:"/articles"},{name:"音乐",path:"/music"},{name:"图库",path:"/gallery"}];function P(){var e=(0,b.useRouter)(),n=(0,i.useState)(""),t=n[0],o=n[1],a=(0,i.useState)(!1),s=a[0],y=a[1],P=function(){y(!s)},M=(0,S.jsx)(f.A,{onClick:P,sx:{textAlign:"center"},children:(0,S.jsx)(c.A,{children:N.map(function(e){return(0,S.jsx)(l.Ay,{disablePadding:!0,children:(0,S.jsx)(h.A,{sx:{textAlign:"center"},href:e.path,target:"_blank",children:(0,S.jsx)(u.A,{primary:e.name})})},e.name)})})});return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(x.A,{position:"static",children:(0,S.jsx)(j.A,{maxWidth:"xl",children:(0,S.jsxs)(g.A,{disableGutters:!0,children:[(0,S.jsxs)(r.A,{sx:{position:"relative",ml:1,transform:"translateY(4px)"},children:[(0,S.jsx)(d.A,{sx:{width:20,position:"absolute",bottom:"50%",left:"50%",transform:"translateX(-50%)"}}),(0,S.jsx)(w.A,{})]}),(0,S.jsx)(v.A,{variant:"h6",noWrap:!0,component:"a",sx:{ml:1,mr:2,fontWeight:700,letterSpacing:".3rem",textDecoration:"none",cursor:"pointer"},style:{color:"white"},href:"/",onClick:function(){return e.push("/")},children:"和谐历史档案馆"}),(0,S.jsxs)(R,{sx:{display:{xs:"none",sm:"none",md:"flex",lg:"flex",xl:"flex"}},children:[(0,S.jsx)(L,{children:(0,S.jsx)(k.A,{})}),(0,S.jsx)(I,{placeholder:"全站搜索",onKeyDown:function(e){if("Enter"===e.key){var n;if(null!==(n=E)&&void 0!==E&&null!==(n=n.env)&&void 0!==n&&n.LOCAL_SEARCH_ENGINE){window.open("".concat(location.protocol,"//").concat(location.host,"/search?keyword=")+encodeURIComponent(t),"_blank");return}window.open("https://www.google.com/search?q="+encodeURIComponent("site:banned-historical-archives.github.io "+t),"_blank")}},value:t,onChange:function(e){return o(e.target.value)},inputProps:{"aria-label":"search"}})]}),(0,S.jsx)(r.A,{sx:{flex:1}}),(0,S.jsxs)(r.A,{sx:{display:{xs:"none",sm:"flex"}},direction:"row",justifyContent:"flex-end",children:[N.map(function(n){var t=n.name,r=n.path;return(0,S.jsx)(A.A,{sx:{color:"white"},onClick:function(){return e.push(r)},children:t},r)}),(0,S.jsxs)(A.A,{href:"https://github.com/banned-historical-archives/banned-historical-archives.github.io/issues",target:"_blank",sx:{color:"white"},children:[(0,S.jsx)(_.A,{sx:{mr:1}}),"讨论"]})]}),(0,S.jsx)(C.A,{size:"small",edge:"start",color:"inherit","aria-label":"menu",sx:{display:{xs:"flex",sm:"none"}},onClick:P,children:(0,S.jsx)(p.A,{})})]})})}),(0,S.jsx)(f.A,{component:"nav",children:(0,S.jsx)(m.Ay,{variant:"temporary",anchor:"right",open:s,onClose:P,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:240}},children:M})})]})}function M(){return null}var z=t(3815);function U(e){var n=e.children,t=(0,i.useState)(!1),o=t[0],a=t[1],s=(0,b.useRouter)();return(0,i.useEffect)(function(){var e=function(e){a(!0)},n=function(){a(!1)};return s.events.on("routeChangeStart",e),s.events.on("routeChangeComplete",n),s.events.on("routeChangeError",n),function(){s.events.off("routeChangeStart",e),s.events.off("routeChangeComplete",n),s.events.off("routeChangeError",n)}},[s]),(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(r.A,{sx:{position:"absolute",height:"100%",width:"100%"},direction:"column",children:[(0,S.jsx)(P,{}),o?(0,S.jsxs)(r.A,{spacing:1,p:2,children:[(0,S.jsx)(z.A,{variant:"text",sx:{fontSize:"1rem"}}),(0,S.jsx)(z.A,{variant:"rectangular",height:60}),(0,S.jsx)(z.A,{variant:"rectangular",height:60}),(0,S.jsx)(z.A,{variant:"rectangular",height:60}),(0,S.jsx)(z.A,{variant:"rectangular",height:60})]}):(0,S.jsx)("main",{style:{flex:1,position:"relative",overflow:"hidden"},children:n}),(0,S.jsx)(M,{})]})})}},9738:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>x});var r=t(3439),i=t(4756),o=t.n(i),a=t(6540),s=t(3368),c=t.n(s),l=t(4976),h=t(1423),u=t(2819),d=t(1952),p=t(4848);function x(){var e=(0,a.useState)(10),n=e[0];e[1];var t=(0,a.useState)(0),i=t[0],s=t[1],l=(0,a.useState)(1),x=l[0],f=l[1],m=(0,a.useState)(),g=m[0],v=m[1];function j(){return(j=(0,r.A)(o().mark(function e(n,t,r){var i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("localhost"==location.hostname||"127.0.0.1"==location.hostname?"".concat(location.protocol,"//").concat(location.host,":9200"):"".concat(location.protocol,"//").concat(location.hostname,"/search_api"),"/article/_search/?source=").concat(encodeURIComponent(JSON.stringify({from:r,size:t,query:{match_phrase:{content:n}},highlight:{fields:{content:{}}}})),"&source_content_type=").concat(encodeURIComponent("application/json")));case 2:return e.next=4,e.sent.json();case 4:console.log(i=e.sent),v(i.hits);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var A=(0,a.useState)(""),w=A[0],b=A[1];if((0,a.useEffect)(function(){var e=new URLSearchParams(location.search).get("keyword");b(e),function(e,n,t){j.apply(this,arguments)}(e,n,i)},[n,i]),(0,a.useEffect)(function(){s(n*(x-1))},[x,n]),!g)return null;var _=Math.ceil(g.total.value/n);return(0,p.jsxs)(u.A,{p:2,sx:{height:"100%",overflow:"scroll"},children:[(0,p.jsx)(c(),{children:(0,p.jsx)("title",{children:"和谐历史档案馆 Banned Historical Archives"})}),(0,p.jsxs)(d.A,{variant:"h4",sx:{mb:1},children:["搜索:",w]}),g.hits.map(function(e){return(0,p.jsxs)("div",{children:[(0,p.jsxs)("a",{href:"/articles/".concat(e._source.article_id,"?publication_id=").concat(e._source.publication_id),rel:"noreferrer",target:"_blank",children:[e._source.title,"-",e._source.publication_name]}),e.highlight.content.map(function(e){return(0,p.jsx)("div",{style:{marginLeft:20,fontSize:8},dangerouslySetInnerHTML:{__html:e}},e)})]},e._id)}),(0,p.jsxs)("div",{children:[(0,p.jsx)(h.A,{onClick:function(){x>1&&f(x-1)},children:"上一页"}),x,"/",_,(0,p.jsx)(h.A,{onClick:function(){x<_&&f(x+1)},children:"下一页"})]})]})}x.getLayout=function(e){return(0,p.jsx)(l.A,{children:e})}},655:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/search",function(){return t(9738)}])},3439:(e,n,t)=>{"use strict";function r(e,n,t,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){t(e);return}s.done?n(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var n=this,t=arguments;return new Promise(function(i,o){var a=e.apply(n,t);function s(e){r(a,i,o,s,c,"next",e)}function c(e){r(a,i,o,s,c,"throw",e)}s(void 0)})}}t.d(n,{A:()=>i})}},e=>{var n=n=>e(e.s=n);e.O(0,[228,636,593,792],()=>n(655)),_N_E=e.O()}]);